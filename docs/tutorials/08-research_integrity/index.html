
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="icon" href="../../assets/img/favicon.ico">
      <meta name="generator" content="mkdocs-1.2.2, mkdocs-material-7.2.6">
    
    
      
        <title>Usage of Trust Markers in research - Dimensions BigQuery Lab</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.802231af.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.3f5d1f46.min.css">
        
      
    
    
    

  <!-- OneTrust Cookies Consent Notice start for dimensions.ai -->
  <script type="text/javascript" src="https://cdn.cookielaw.org/consent/3329b668-7887-4dba-9bee-c3853a706e6f/OtAutoBlock.js"></script>
  <script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" type="text/javascript" charset="UTF-8" data-domain-script="3329b668-7887-4dba-9bee-c3853a706e6f"></script>
  <script type="text/javascript">
      function OptanonWrapper() { }
  </script>
  <!-- OneTrust Cookies Consent Notice end for dimensions.ai -->

    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
    
      

  


  

  


  <script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-BWP057HYGP"),document.addEventListener("DOMContentLoaded",function(){"undefined"!=typeof location$&&location$.subscribe(function(t){gtag("config","G-BWP057HYGP",{page_path:t.pathname})})})</script>
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-BWP057HYGP"></script>


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    <script>function __prefix(e){return new URL("../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#usage-of-trust-markers-in-research" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Dimensions BigQuery Lab" class="md-header__button md-logo" aria-label="Dimensions BigQuery Lab" data-md-component="logo">
      
  <img src="../../assets/img/apple-touch-icon.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Dimensions BigQuery Lab
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Usage of Trust Markers in research
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Dimensions BigQuery Lab" class="md-nav__button md-logo" aria-label="Dimensions BigQuery Lab" data-md-component="logo">
      
  <img src="../../assets/img/apple-touch-icon.png" alt="logo">

    </a>
    Dimensions BigQuery Lab
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" checked>
      
      <label class="md-nav__link" for="__nav_2">
        Tutorials
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Tutorials" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Tutorials
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        About Tutorials
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../01-connection/" class="md-nav__link">
        Verifying your connection
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../03-dates/" class="md-nav__link">
        Working with dates
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../04-nested/" class="md-nav__link">
        Working with nested and repeated fields
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../02-dsl/" class="md-nav__link">
        From the DSL API to Google BigQuery
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../05-topic_clusters/" class="md-nav__link">
        Basic Topic Clustering using TensorFlow and BigQuery ML
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../06-funder_grant_pubs/" class="md-nav__link">
        Identify a funder's grants and publications
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../07-retrieve_patents/" class="md-nav__link">
        Retrieve patents linked to a set of grants
      </a>
    </li>
  

          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Usage of Trust Markers in research
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Usage of Trust Markers in research
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#use-case" class="md-nav__link">
    Use case
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#about-trust-markers" class="md-nav__link">
    About Trust Markers
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#method" class="md-nav__link">
    Method
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-connect" class="md-nav__link">
    1. Connect
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-trust-markers-by-publisher" class="md-nav__link">
    2. Trust Markers by publisher
  </a>
  
    <nav class="md-nav" aria-label="2. Trust Markers by publisher">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#write-and-run-a-query" class="md-nav__link">
    Write and run a query
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#visualize-your-results" class="md-nav__link">
    Visualize your results
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-trust-markers-by-research-org" class="md-nav__link">
    3. Trust Markers by research org
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-author-contributions-to-articles" class="md-nav__link">
    4. Author contributions to articles
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-repository-usage" class="md-nav__link">
    5. Repository usage
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      <label class="md-nav__link" for="__nav_3">
        Collections
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Collections" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Collections
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../collections/" class="md-nav__link">
        About
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../collections/01-publications/" class="md-nav__link">
        Publications
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../collections/02-citations/" class="md-nav__link">
        Citations
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../collections/03-authors/" class="md-nav__link">
        Authors
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../collections/04-funding/" class="md-nav__link">
        Funding & Grants
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      <label class="md-nav__link" for="__nav_4">
        Queries
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Queries" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Queries
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../queries/" class="md-nav__link">
        About Queries
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../queries/01/" class="md-nav__link">
        1. Number of publications added to Dimensions each month
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../queries/02/" class="md-nav__link">
        2. Number of Publications by Type
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../queries/03/" class="md-nav__link">
        3. Generate a list of publication authors by flattening/concatenating nested data
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../queries/04/" class="md-nav__link">
        4. Generate a list of publication categories by flattening/concatenating nested data
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../queries/05/" class="md-nav__link">
        5. Number of publications per SDG category
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../queries/06/" class="md-nav__link">
        6. Publications count per FoR category, total and percentage against total
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../queries/07/" class="md-nav__link">
        7. Finding Journals using string matching
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../queries/08/" class="md-nav__link">
        8. Finding articles matching a specific affiliation string
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../queries/09/" class="md-nav__link">
        9. Top publications by Altmetric score and research organization
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../queries/10/" class="md-nav__link">
        10. Select publications matching selected concepts
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../queries/11/" class="md-nav__link">
        11. Count of corresponding authors by publisher
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../queries/12/" class="md-nav__link">
        12. Counting new vs recurring authors, for a specific journal
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../queries/13/" class="md-nav__link">
        13. Funding by journal
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../queries/14/" class="md-nav__link">
        14. Extracting complex publications records
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../queries/15/" class="md-nav__link">
        15. Top N publications by citations percentile
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../queries/16/" class="md-nav__link">
        16. Citations by journal, for a specific publisher
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../queries/17/" class="md-nav__link">
        17. One-degree citation network for a single publication
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../queries/18/" class="md-nav__link">
        18. Incoming citations for a journal
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../queries/19/" class="md-nav__link">
        19. Outgoing citations from a journal
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../queries/20/" class="md-nav__link">
        20. International collaboration of an organisation in a field
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../queries/21/" class="md-nav__link">
        21. International collaboration rate of individuals, with context
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../queries/22/" class="md-nav__link">
        22. Incoming citations for a single publication, by journal
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../queries/23/" class="md-nav__link">
        23. Citing authors by country
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../queries/24/" class="md-nav__link">
        24. Organizations and sub-organizations
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../queries/25/" class="md-nav__link">
        25. Grants for an organization
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../queries/26/" class="md-nav__link">
        26. Field Citation Ratio (FCR) median average
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../queries/27/" class="md-nav__link">
        27. List of corresponding authors
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../queries/28/" class="md-nav__link">
        28. Researcher collaborations
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../queries/29/" class="md-nav__link">
        29. Institutions collaborations
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../queries/30/" class="md-nav__link">
        30. Publication volume growth rate
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../queries/31/" class="md-nav__link">
        31. Country-level publication activity over time
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../queries/32/" class="md-nav__link">
        32. Creating a concepts network
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../queries/33/" class="md-nav__link">
        33. Calculating disruption indices (CD index)
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#use-case" class="md-nav__link">
    Use case
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#about-trust-markers" class="md-nav__link">
    About Trust Markers
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#method" class="md-nav__link">
    Method
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-connect" class="md-nav__link">
    1. Connect
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-trust-markers-by-publisher" class="md-nav__link">
    2. Trust Markers by publisher
  </a>
  
    <nav class="md-nav" aria-label="2. Trust Markers by publisher">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#write-and-run-a-query" class="md-nav__link">
    Write and run a query
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#visualize-your-results" class="md-nav__link">
    Visualize your results
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-trust-markers-by-research-org" class="md-nav__link">
    3. Trust Markers by research org
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-author-contributions-to-articles" class="md-nav__link">
    4. Author contributions to articles
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-repository-usage" class="md-nav__link">
    5. Repository usage
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="usage-of-trust-markers-in-research">Usage of Trust Markers in research</h1>
<h2 id="use-case">Use case</h2>
<p>'Trust Markers' are indicators of integrity, professionalism and reproducibility in scientific research. They also highlight the level of research transparency within the document, and reduce the risks of allowing non-compliance to research integrity policies to go unobserved.</p>
<p>This notebook takes you through a few examples which address the above questions. It makes use of the <a href="https://ripeta.com/solutions/dimensions-research-integrity/">Dimensions Research Integrity Dataset</a>, an additional module to Dimensions on Google Big Query (GBQ).</p>
<p>Using the dataset, you can answer questions such as:</p>
<ul>
<li>How many research articles use Trust Markers?</li>
<li>How does coverage of Trust Markers differ across publishers, funders and research organisations?</li>
<li>If researchers are using Trust Markers (eg, data availability statements), how many are putting their data in repositories (and which repositories)?</li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Prerequisites</p>
<p>In order to run this tutorial, please ensure that:</p>
<ul>
<li>You have a valid <a href="https://www.dimensions.ai/products/bigquery/">Dimensions on Google BigQuery account</a> and have <a href="https://docs.dimensions.ai/bigquery/gcp-setup.html#">configured a Google Cloud project</a>. This must include access to the Dimensions Research Integrity Dataset.</li>
<li>You have some basic familiarity with Python and <a href="https://jupyter.org/">Jupyter notebooks</a>.</li>
</ul>
</div>
<h2 id="about-trust-markers">About Trust Markers</h2>
<p>The Trust Markers in the Dataset represent the integrity and reproducibility of scientific research. Trust Markers represent a contract between authors and readers that proper research practices have been observed. They also highlight the level of research transparency within the document, and reduce the risks of allowing non-compliance to research integrity policies to go unobserved.</p>
<p>To read definitions of specific Trust Markers, see the <a href="https://docs.dimensions.ai/bigquery/datasource-dri-trust-markers.html">GBQ schema documentation</a>.</p>
<h2 id="method">Method</h2>
<p>This notebook retrieves data about trust marker and publication data from Dimensions, the world's largest linked research information datatset. In particular the Trust Markers are taken from the DRI module.</p>
<p>To complete the analysis the following steps are taken:</p>
<ol>
<li>Connect to the Dimensions database.</li>
<li>Gather information about general use of Trust Markers, broken down by publisher.</li>
<li>Look at how usage of Trust Markers breaks down by research organisations in the US, by joining on data from <a href="https://www.digital-science.com/resource/grid/">GRID</a>.</li>
<li>Find out some of the most commonly claimed contributions by inviduals to research across different fields.</li>
<li>Understand the usage of repositories across funders, research orgs and research articles.</li>
</ol>
<h2 id="1-connect">1. Connect</h2>
<p>You will need to be authenticated to run these queries - see the <a href="https://bigquery-lab.dimensions.ai/tutorials/01-connection/">"Verifying yout connection"</a> tutorial for options.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">google.colab</span> <span class="kn">import</span> <span class="n">auth</span>
<span class="n">auth</span><span class="o">.</span><span class="n">authenticate_user</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Authenticated&#39;</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>Authenticated
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1">#import other packages/modules needed for analysis</span>
<span class="kn">from</span> <span class="nn">google.cloud</span> <span class="kn">import</span> <span class="n">bigquery</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">plotly.express</span> <span class="k">as</span> <span class="nn">px</span>
<span class="kn">import</span> <span class="nn">plotly.graph_objs</span> <span class="k">as</span> <span class="nn">go</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1">#config to avoid having to declare parameters multiple times</span>
<span class="n">project_id</span> <span class="o">=</span> <span class="s2">&quot;ds-ripeta-gbq&quot;</span> <span class="c1">#replace &#39;project&#39; with the required project associate with your account</span>

<span class="kn">from</span> <span class="nn">google.cloud.bigquery</span> <span class="kn">import</span> <span class="n">magics</span>
<span class="n">magics</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">project</span> <span class="o">=</span> <span class="n">project_id</span>

<span class="n">client</span> <span class="o">=</span> <span class="n">bigquery</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="n">project</span> <span class="o">=</span> <span class="n">project_id</span><span class="p">)</span>
</code></pre></div>
<h2 id="2-trust-markers-by-publisher">2. Trust Markers by publisher</h2>
<h3 id="write-and-run-a-query">Write and run a query</h3>
<p>In this instance we will limit data to 2022 and 10 publishers to keep things manageable.</p>
<div class="highlight"><pre><span></span><code><span class="c1">#write the query - we&#39;re limiting results here to keep things easy to follow</span>
<span class="n">qry</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">SELECT</span>
<span class="s2">    p.publisher.name,</span>
<span class="s2">    100 * COUNTIF(tm.data.data_availability_statement.present)/ COUNT(p.id) AS data_availability,</span>
<span class="s2">    100 * COUNTIF(tm.code.code_availability_statement.present)/COUNT(p.id) AS code_availability,</span>
<span class="s2">    100 * COUNTIF(tm.authors.author_contribution_statement.present)/COUNT(p.id) AS author_contributions,</span>
<span class="s2">    100 * COUNTIF(tm.authors.conflict_of_interest_statement.present)/COUNT(p.id) AS conflict_interest,</span>
<span class="s2">    100 * COUNTIF(tm.funding.funding_statement.present)/COUNT(p.id) AS funding_statement,</span>
<span class="s2">    #note here we are only counting articles with mesh terms of &#39;animal&#39; or &#39;human&#39; as if this criteria isn&#39;t met it is unlikely an ethics statement would be expected</span>
<span class="s2">    100 * COUNTIF((tm.ethical_approval.ethical_approval_statement.present AND ((&#39;Humans&#39; IN UNNEST(p.mesh_terms)) OR (&#39;Animals&#39; IN UNNEST(p.mesh_terms)))) )/</span>
<span class="s2">        NULLIF(COUNTIF((&#39;Humans&#39; in UNNEST(p.mesh_terms)) OR (&#39;Animals&#39; IN unnest(p.mesh_terms))), 0) AS ethics_approval</span>
<span class="s2">FROM</span>
<span class="s2">    dimensions-ai.data_analytics.publications p</span>
<span class="s2">INNER JOIN `dimensions-ai-integrity.data.trust_markers` tm</span>
<span class="s2">    ON p.id = tm.id</span>
<span class="s2">WHERE p.year = 2022 AND p.document_type.classification = &#39;RESEARCH_ARTICLE&#39;</span>
<span class="s2">GROUP BY 1</span>
<span class="s2">ORDER BY COUNT(p.id) DESC #order by number of publications in the trust marker dataset</span>
<span class="s2">--To keep things manageable for display purposes, we&#39;ll only look at 10 publishers for now</span>
<span class="s2">LIMIT 10</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>

<span class="c1">#get the results</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">qry</span><span class="o">.</span><span class="n">result</span><span class="p">()</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">()</span> <span class="c1">#may take a while depending on how much data your return</span>

<span class="c1">#take a peak</span>
<span class="n">results</span>
</code></pre></div>
<div id="df-f9c1d925-b84b-4166-93f3-6df07095fdb5">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>data_availability</th>
      <th>code_availability</th>
      <th>author_contributions</th>
      <th>conflict_interest</th>
      <th>funding_statement</th>
      <th>ethics_approval</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Elsevier</td>
      <td>22.890000</td>
      <td>1.597544</td>
      <td>17.378246</td>
      <td>80.405263</td>
      <td>57.918947</td>
      <td>18.943601</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Springer Nature</td>
      <td>49.878036</td>
      <td>8.742873</td>
      <td>52.908014</td>
      <td>40.728133</td>
      <td>71.049643</td>
      <td>65.175558</td>
    </tr>
    <tr>
      <th>2</th>
      <td>MDPI</td>
      <td>88.760718</td>
      <td>1.339980</td>
      <td>97.192921</td>
      <td>99.243270</td>
      <td>91.880857</td>
      <td>13.336054</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Wiley</td>
      <td>39.376133</td>
      <td>1.139870</td>
      <td>20.882104</td>
      <td>7.671746</td>
      <td>58.562563</td>
      <td>16.154602</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Frontiers</td>
      <td>97.583713</td>
      <td>1.031047</td>
      <td>99.547012</td>
      <td>6.398587</td>
      <td>79.234019</td>
      <td>75.641116</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Taylor &amp; Francis</td>
      <td>17.195639</td>
      <td>0.605616</td>
      <td>11.305576</td>
      <td>83.174962</td>
      <td>52.912265</td>
      <td>28.457937</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Institute of Electrical and Electronics Engine...</td>
      <td>0.300312</td>
      <td>0.723896</td>
      <td>0.208514</td>
      <td>0.599313</td>
      <td>3.561780</td>
      <td>5.201794</td>
    </tr>
    <tr>
      <th>7</th>
      <td>American Chemical Society (ACS)</td>
      <td>2.348741</td>
      <td>0.794581</td>
      <td>42.137319</td>
      <td>1.914696</td>
      <td>75.219210</td>
      <td>4.040979</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Hindawi</td>
      <td>85.378842</td>
      <td>1.029393</td>
      <td>23.275609</td>
      <td>85.217410</td>
      <td>52.681454</td>
      <td>23.068174</td>
    </tr>
    <tr>
      <th>9</th>
      <td>SAGE Publications</td>
      <td>9.527544</td>
      <td>0.604082</td>
      <td>18.841010</td>
      <td>4.317599</td>
      <td>90.031582</td>
      <td>33.596158</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-f9c1d925-b84b-4166-93f3-6df07095fdb5')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-f9c1d925-b84b-4166-93f3-6df07095fdb5 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-f9c1d925-b84b-4166-93f3-6df07095fdb5');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>

<h3 id="visualize-your-results">Visualize your results</h3>
<div class="highlight"><pre><span></span><code><span class="c1">#make data &#39;long&#39;</span>
<span class="n">long_results</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span>
    <span class="n">results</span><span class="p">,</span>
    <span class="n">id_vars</span> <span class="o">=</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span>
    <span class="n">value_vars</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">1</span><span class="p">:</span><span class="mi">7</span><span class="p">],</span>
    <span class="n">var_name</span> <span class="o">=</span> <span class="s2">&quot;trust_marker&quot;</span><span class="p">,</span>
    <span class="n">value_name</span> <span class="o">=</span> <span class="s2">&quot;pct&quot;</span>
    <span class="p">)</span>

<span class="c1">#convert your data to a dictionary so plotly can handle it</span>
<span class="n">result_dict</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;z&quot;</span><span class="p">:</span> <span class="n">long_results</span><span class="o">.</span><span class="n">pct</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
    <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="n">long_results</span><span class="o">.</span><span class="n">trust_marker</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
    <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="n">long_results</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="p">}</span>

<span class="c1">#plot</span>
<span class="n">plot</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Heatmap</span><span class="p">(</span>
        <span class="n">result_dict</span><span class="p">,</span>
        <span class="n">colorscale</span> <span class="o">=</span> <span class="s2">&quot;Blues&quot;</span>
        <span class="p">)</span>
    <span class="p">)</span>

<span class="n">plot</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>
<p><html>
<head><meta charset="utf-8" /></head></p>
<body>
    <div>            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script src="https://cdn.plot.ly/plotly-2.18.2.min.js"></script>                <div id="ddd7db84-31c9-4b4c-aa14-ad094b3a5518" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("ddd7db84-31c9-4b4c-aa14-ad094b3a5518")) {                    Plotly.newPlot(                        "ddd7db84-31c9-4b4c-aa14-ad094b3a5518",                        [{"colorscale":[[0.0,"rgb(247,251,255)"],[0.125,"rgb(222,235,247)"],[0.25,"rgb(198,219,239)"],[0.375,"rgb(158,202,225)"],[0.5,"rgb(107,174,214)"],[0.625,"rgb(66,146,198)"],[0.75,"rgb(33,113,181)"],[0.875,"rgb(8,81,156)"],[1.0,"rgb(8,48,107)"]],"x":["data_availability","data_availability","data_availability","data_availability","data_availability","data_availability","data_availability","data_availability","data_availability","data_availability","code_availability","code_availability","code_availability","code_availability","code_availability","code_availability","code_availability","code_availability","code_availability","code_availability","author_contributions","author_contributions","author_contributions","author_contributions","author_contributions","author_contributions","author_contributions","author_contributions","author_contributions","author_contributions","conflict_interest","conflict_interest","conflict_interest","conflict_interest","conflict_interest","conflict_interest","conflict_interest","conflict_interest","conflict_interest","conflict_interest","funding_statement","funding_statement","funding_statement","funding_statement","funding_statement","funding_statement","funding_statement","funding_statement","funding_statement","funding_statement","ethics_approval","ethics_approval","ethics_approval","ethics_approval","ethics_approval","ethics_approval","ethics_approval","ethics_approval","ethics_approval","ethics_approval"],"y":["Elsevier","Springer Nature","MDPI","Wiley","Frontiers","Taylor & Francis","Institute of Electrical and Electronics Engineers (IEEE)","American Chemical Society (ACS)","Hindawi","SAGE Publications","Elsevier","Springer Nature","MDPI","Wiley","Frontiers","Taylor & Francis","Institute of Electrical and Electronics Engineers (IEEE)","American Chemical Society (ACS)","Hindawi","SAGE Publications","Elsevier","Springer Nature","MDPI","Wiley","Frontiers","Taylor & Francis","Institute of Electrical and Electronics Engineers (IEEE)","American Chemical Society (ACS)","Hindawi","SAGE Publications","Elsevier","Springer Nature","MDPI","Wiley","Frontiers","Taylor & Francis","Institute of Electrical and Electronics Engineers (IEEE)","American Chemical Society (ACS)","Hindawi","SAGE Publications","Elsevier","Springer Nature","MDPI","Wiley","Frontiers","Taylor & Francis","Institute of Electrical and Electronics Engineers (IEEE)","American Chemical Society (ACS)","Hindawi","SAGE Publications","Elsevier","Springer Nature","MDPI","Wiley","Frontiers","Taylor & Francis","Institute of Electrical and Electronics Engineers (IEEE)","American Chemical Society (ACS)","Hindawi","SAGE Publications"],"z":[22.89,49.878036061926394,88.76071784646062,39.376133392995925,97.58371345090703,17.19563866448223,0.3003121147743069,2.3487407459264573,85.3788418801627,9.527544034422094,1.5975438596491227,8.74287336608881,1.3399800598205385,1.1398695273309625,1.031047022470729,0.6056155019490425,0.7238964513337005,0.7945814445980713,1.02939326596503,0.6040823247631362,17.378245614035087,52.908014276443865,97.19292123629113,20.88210357740044,99.54701196056587,11.305575956160668,0.20851365174285938,42.137319075205205,23.27560904021133,18.84100977129655,80.40526315789474,40.7281334013164,99.24327018943171,7.671745837356633,6.398587434048725,83.1749618665612,0.5993128229338789,1.9146962563662775,85.21740953499099,4.317598931728099,57.91894736842105,71.04964308890331,91.88085742771685,58.5625632933751,79.23401929665987,52.912264843794134,3.561780365620164,75.21920996902182,52.68145414902092,90.03158184785603,18.943601038307243,65.17555777726507,13.336054160464782,16.154602030789388,75.64111571699571,28.457936549692217,5.201793721973094,4.040978941377348,23.06817373995877,33.5961579815067],"type":"heatmap"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}}},                        {"responsive": true}                    ).then(function(){

var gd = document.getElementById('ddd7db84-31c9-4b4c-aa14-ad094b3a5518');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                            </script>        </div>
</body>
<p></html></p>
<h2 id="3-trust-markers-by-research-org">3. Trust Markers by research org</h2>
<p>There are plenty of other analyses we can carry out using DRI. We are also not obliged to pull in aggregated data - we can also pull in data 'row-by-row' and analyse further in Python. We'll do this in the next example to look at the proportion of articles using Trust Markers at US universities.</p>
<p>Note that this example is set up to work generally. In a notebook environment (like Colab or Jupyter) you can use magic commands to reduce the code down to just the query and store as a summary dataframe. Google has <a href="https://cloud.google.com/bigquery/docs/visualize-jupyter">guidance on doing this</a>. We will use this magic commands in future examples.</p>
<div class="highlight"><pre><span></span><code><span class="o">%%</span><span class="n">bigquery</span> <span class="n">markers_by_us_uni</span>

<span class="n">SELECT</span>
    <span class="n">p</span><span class="o">.</span><span class="n">id</span> <span class="n">AS</span> <span class="n">pub_id</span><span class="p">,</span>
    <span class="n">p</span><span class="o">.</span><span class="n">year</span><span class="p">,</span>
    <span class="n">orgs</span> <span class="n">AS</span> <span class="n">org_id</span><span class="p">,</span>
    <span class="n">CONCAT</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s1">&#39; (&#39;</span><span class="p">,</span> <span class="n">g</span><span class="o">.</span><span class="n">address</span><span class="o">.</span><span class="n">city</span><span class="p">,</span> <span class="s1">&#39;)&#39;</span><span class="p">)</span> <span class="n">AS</span> <span class="n">org_name</span><span class="p">,</span>
    <span class="n">tm</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">data_availability_statement</span><span class="o">.</span><span class="n">present</span> <span class="n">AS</span> <span class="n">das</span><span class="p">,</span>
    <span class="n">tm</span><span class="o">.</span><span class="n">code</span><span class="o">.</span><span class="n">code_availability_statement</span><span class="o">.</span><span class="n">present</span> <span class="n">AS</span> <span class="n">cas</span><span class="p">,</span>
    <span class="n">tm</span><span class="o">.</span><span class="n">authors</span><span class="o">.</span><span class="n">author_contribution_statement</span><span class="o">.</span><span class="n">present</span> <span class="n">AS</span> <span class="n">auth_cont</span><span class="p">,</span>
    <span class="n">tm</span><span class="o">.</span><span class="n">authors</span><span class="o">.</span><span class="n">conflict_of_interest_statement</span><span class="o">.</span><span class="n">present</span> <span class="n">AS</span> <span class="n">conflict_int</span><span class="p">,</span>
    <span class="n">tm</span><span class="o">.</span><span class="n">funding</span><span class="o">.</span><span class="n">funding_statement</span><span class="o">.</span><span class="n">present</span> <span class="n">AS</span> <span class="n">funding</span><span class="p">,</span>
    <span class="n">CASE</span>
      <span class="n">WHEN</span> <span class="n">tm</span><span class="o">.</span><span class="n">ethical_approval</span><span class="o">.</span><span class="n">ethical_approval_statement</span><span class="o">.</span><span class="n">present</span> <span class="n">IS</span> <span class="n">TRUE</span> <span class="n">AND</span> <span class="p">(</span><span class="s1">&#39;Humans&#39;</span> <span class="n">IN</span> <span class="n">UNNEST</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">mesh_terms</span><span class="p">)</span> <span class="n">OR</span> <span class="s1">&#39;Animals&#39;</span> <span class="n">IN</span> <span class="n">UNNEST</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">mesh_terms</span><span class="p">))</span> <span class="n">THEN</span> <span class="n">TRUE</span>
      <span class="n">WHEN</span> <span class="n">tm</span><span class="o">.</span><span class="n">ethical_approval</span><span class="o">.</span><span class="n">ethical_approval_statement</span><span class="o">.</span><span class="n">present</span> <span class="n">IS</span> <span class="n">FALSE</span> <span class="n">AND</span> <span class="p">(</span><span class="s1">&#39;Humans&#39;</span> <span class="n">IN</span> <span class="n">UNNEST</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">mesh_terms</span><span class="p">)</span> <span class="n">OR</span> <span class="s1">&#39;Animals&#39;</span> <span class="n">IN</span> <span class="n">UNNEST</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">mesh_terms</span><span class="p">))</span> <span class="n">THEN</span> <span class="n">FALSE</span>
      <span class="n">ELSE</span> <span class="n">NULL</span>
      <span class="n">END</span> <span class="n">AS</span> <span class="n">ethics</span>
<span class="n">FROM</span> <span class="n">dimensions</span><span class="o">-</span><span class="n">ai</span><span class="o">.</span><span class="n">data_analytics</span><span class="o">.</span><span class="n">publications</span> <span class="n">p</span><span class="p">,</span>
     <span class="n">UNNEST</span><span class="p">(</span><span class="n">research_orgs</span><span class="p">)</span> <span class="n">orgs</span>
<span class="n">INNER</span> <span class="n">JOIN</span> <span class="err">`</span><span class="n">dimensions</span><span class="o">-</span><span class="n">ai</span><span class="o">-</span><span class="n">integrity</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">trust_markers</span><span class="err">`</span> <span class="n">tm</span>
    <span class="n">ON</span> <span class="n">p</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">tm</span><span class="o">.</span><span class="n">id</span>
<span class="n">INNER</span> <span class="n">JOIN</span> <span class="n">dimensions</span><span class="o">-</span><span class="n">ai</span><span class="o">.</span><span class="n">data_analytics</span><span class="o">.</span><span class="n">grid</span> <span class="n">g</span>
    <span class="n">ON</span> <span class="n">orgs</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">id</span>
    <span class="n">AND</span> <span class="s1">&#39;Education&#39;</span> <span class="n">IN</span> <span class="n">UNNEST</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">types</span><span class="p">)</span>
    <span class="n">AND</span> <span class="n">g</span><span class="o">.</span><span class="n">address</span><span class="o">.</span><span class="n">country</span> <span class="o">=</span> <span class="s2">&quot;United States&quot;</span>
<span class="n">WHERE</span>
    <span class="n">p</span><span class="o">.</span><span class="n">year</span> <span class="o">=</span> <span class="mi">2022</span>
    <span class="n">AND</span> <span class="n">p</span><span class="o">.</span><span class="n">document_type</span><span class="o">.</span><span class="n">classification</span> <span class="o">=</span> <span class="s1">&#39;RESEARCH_ARTICLE&#39;</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>Query is running:   0%|          |



Downloading:   0%|          |
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1">#you can see we&#39;ve got the result straight to a df; take a look</span>
<span class="n">markers_by_us_uni</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</code></pre></div>
<div id="df-35fa28d7-9722-4b74-9855-cded5ca7315b">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pub_id</th>
      <th>year</th>
      <th>org_id</th>
      <th>org_name</th>
      <th>das</th>
      <th>cas</th>
      <th>auth_cont</th>
      <th>conflict_int</th>
      <th>funding</th>
      <th>ethics</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>pub.1141586193</td>
      <td>2022</td>
      <td>grid.36425.36</td>
      <td>Stony Brook University (Stony Brook)</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>&lt;NA&gt;</td>
    </tr>
    <tr>
      <th>1</th>
      <td>pub.1141411763</td>
      <td>2022</td>
      <td>grid.5288.7</td>
      <td>Oregon Health &amp; Science University (Portland)</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2</th>
      <td>pub.1141060825</td>
      <td>2022</td>
      <td>grid.262273.0</td>
      <td>Queens College, CUNY (New York)</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>3</th>
      <td>pub.1140891786</td>
      <td>2022</td>
      <td>grid.255935.d</td>
      <td>Fisk University (Nashville)</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>&lt;NA&gt;</td>
    </tr>
    <tr>
      <th>4</th>
      <td>pub.1141168735</td>
      <td>2022</td>
      <td>grid.152326.1</td>
      <td>Vanderbilt University (Nashville)</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>True</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-35fa28d7-9722-4b74-9855-cded5ca7315b')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-35fa28d7-9722-4b74-9855-cded5ca7315b button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-35fa28d7-9722-4b74-9855-cded5ca7315b');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>

<div class="highlight"><pre><span></span><code><span class="c1">#now we&#39;ll manipulate as required in Python</span>
<span class="n">marker_df</span> <span class="o">=</span> <span class="n">markers_by_us_uni</span>

<span class="c1">#flag marker cols</span>
<span class="n">marker_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;das&quot;</span><span class="p">,</span> <span class="s2">&quot;cas&quot;</span><span class="p">,</span> <span class="s2">&quot;auth_cont&quot;</span><span class="p">,</span> <span class="s2">&quot;conflict_int&quot;</span><span class="p">,</span> <span class="s2">&quot;funding&quot;</span><span class="p">,</span> <span class="s2">&quot;ethics&quot;</span><span class="p">]</span>

<span class="c1">#work out if there is a least one marker</span>
<span class="n">marker_df</span><span class="p">[</span><span class="s2">&quot;tm&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">marker_df</span><span class="p">[</span><span class="n">marker_cols</span><span class="p">]</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1">#institutions w/ &lt;=1,000 publications</span>
<span class="n">gt1000</span> <span class="o">=</span> <span class="p">(</span><span class="n">marker_df</span><span class="o">.</span>
          <span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;org_id&quot;</span><span class="p">],</span> <span class="n">as_index</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span><span class="o">.</span>
          <span class="n">agg</span><span class="p">({</span><span class="s2">&quot;pub_id&quot;</span><span class="p">:</span> <span class="s2">&quot;count&quot;</span><span class="p">})</span>
          <span class="p">)</span>

<span class="n">gt1000</span> <span class="o">=</span> <span class="n">gt1000</span><span class="p">[</span><span class="n">gt1000</span><span class="p">[</span><span class="s2">&quot;pub_id&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">1000</span><span class="p">][</span><span class="s2">&quot;org_id&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>

<span class="c1">#summary</span>
<span class="n">marker_sum</span> <span class="o">=</span> <span class="p">(</span><span class="n">marker_df</span><span class="o">.</span>
              <span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;org_id&quot;</span><span class="p">,</span> <span class="s2">&quot;org_name&quot;</span><span class="p">,</span> <span class="s2">&quot;tm&quot;</span><span class="p">],</span> <span class="n">as_index</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span><span class="o">.</span>
              <span class="n">agg</span><span class="p">({</span><span class="s2">&quot;pub_id&quot;</span><span class="p">:</span> <span class="s2">&quot;count&quot;</span><span class="p">})</span>
<span class="p">)</span>

<span class="c1">#add on %</span>
<span class="n">marker_sum</span><span class="p">[</span><span class="s2">&quot;pct&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">marker_sum</span><span class="p">[</span><span class="s2">&quot;pub_id&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">marker_sum</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;org_id&quot;</span><span class="p">])[</span><span class="s2">&quot;pub_id&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="s2">&quot;sum&quot;</span><span class="p">)</span>

<span class="c1">#remove institutions w/ &lt;=1000 pubs and tm = False rows</span>
<span class="n">marker_sum</span> <span class="o">=</span> <span class="n">marker_sum</span><span class="p">[(</span><span class="n">marker_sum</span><span class="p">[</span><span class="s2">&quot;org_id&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">gt1000</span><span class="p">))</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">marker_sum</span><span class="p">[</span><span class="s2">&quot;tm&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="kc">True</span><span class="p">)]</span>

<span class="c1">#sort and slice to keep data manageable, pick the top 10 by number of publications...</span>
<span class="n">marker_sum</span> <span class="o">=</span> <span class="n">marker_sum</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;pub_id&quot;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="c1">#...then order by pct for purposes of plot</span>
<span class="n">marker_sum</span> <span class="o">=</span> <span class="n">marker_sum</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;pct&quot;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>

<span class="n">marker_sum</span>
</code></pre></div>
<div id="df-4350d97e-79bb-4565-bc81-b60c112b34a6">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>org_id</th>
      <th>org_name</th>
      <th>tm</th>
      <th>pub_id</th>
      <th>pct</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1730</th>
      <td>grid.38142.3c</td>
      <td>Harvard University (Cambridge)</td>
      <td>True</td>
      <td>15532</td>
      <td>85.797934</td>
    </tr>
    <tr>
      <th>1309</th>
      <td>grid.266102.1</td>
      <td>University of California, San Francisco (San F...</td>
      <td>True</td>
      <td>5955</td>
      <td>85.511200</td>
    </tr>
    <tr>
      <th>101</th>
      <td>grid.21107.35</td>
      <td>Johns Hopkins University (Baltimore)</td>
      <td>True</td>
      <td>8246</td>
      <td>84.800494</td>
    </tr>
    <tr>
      <th>3785</th>
      <td>grid.5386.8</td>
      <td>Cornell University (Ithaca)</td>
      <td>True</td>
      <td>5846</td>
      <td>83.765582</td>
    </tr>
    <tr>
      <th>1722</th>
      <td>grid.34477.33</td>
      <td>University of Washington (Seattle)</td>
      <td>True</td>
      <td>7825</td>
      <td>83.475571</td>
    </tr>
    <tr>
      <th>47</th>
      <td>grid.168010.e</td>
      <td>Stanford University (Stanford)</td>
      <td>True</td>
      <td>7731</td>
      <td>83.030824</td>
    </tr>
    <tr>
      <th>713</th>
      <td>grid.25879.31</td>
      <td>University of Pennsylvania (Philadelphia)</td>
      <td>True</td>
      <td>6571</td>
      <td>82.747765</td>
    </tr>
    <tr>
      <th>3647</th>
      <td>grid.47100.32</td>
      <td>Yale University (New Haven)</td>
      <td>True</td>
      <td>5992</td>
      <td>82.488987</td>
    </tr>
    <tr>
      <th>85</th>
      <td>grid.19006.3e</td>
      <td>University of California, Los Angeles (Los Ang...</td>
      <td>True</td>
      <td>6714</td>
      <td>82.329859</td>
    </tr>
    <tr>
      <th>115</th>
      <td>grid.214458.e</td>
      <td>University of Michigan–Ann Arbor (Ann Arbor)</td>
      <td>True</td>
      <td>7672</td>
      <td>80.301444</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-4350d97e-79bb-4565-bc81-b60c112b34a6')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-4350d97e-79bb-4565-bc81-b60c112b34a6 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-4350d97e-79bb-4565-bc81-b60c112b34a6');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>

<div class="highlight"><pre><span></span><code><span class="c1">#plot the data</span>
<span class="n">plot</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">marker_sum</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;pct&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s2">&quot;org_name&quot;</span><span class="p">)</span>
<span class="n">plot</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>
<p><html>
<head><meta charset="utf-8" /></head></p>
<body>
    <div>            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script src="https://cdn.plot.ly/plotly-2.18.2.min.js"></script>                <div id="49056c21-fc71-44d1-813f-6ac5ff6442fc" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("49056c21-fc71-44d1-813f-6ac5ff6442fc")) {                    Plotly.newPlot(                        "49056c21-fc71-44d1-813f-6ac5ff6442fc",                        [{"alignmentgroup":"True","hovertemplate":"pct=%{x}<br>org_name=%{y}<extra></extra>","legendgroup":"","marker":{"color":"#636efa","pattern":{"shape":""}},"name":"","offsetgroup":"","orientation":"h","showlegend":false,"textposition":"auto","x":[85.79793404408109,85.51120045950603,84.80049362402303,83.76558246167073,83.47557072754427,83.03082375684674,82.74776476514293,82.48898678414096,82.32985898221949,80.30144442118484],"xaxis":"x","y":["Harvard University (Cambridge)","University of California, San Francisco (San Francisco)","Johns Hopkins University (Baltimore)","Cornell University (Ithaca)","University of Washington (Seattle)","Stanford University (Stanford)","University of Pennsylvania (Philadelphia)","Yale University (New Haven)","University of California, Los Angeles (Los Angeles)","University of Michigan\u2013Ann Arbor (Ann Arbor)"],"yaxis":"y","type":"bar"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"pct"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"org_name"}},"legend":{"tracegroupgap":0},"margin":{"t":60},"barmode":"relative"},                        {"responsive": true}                    ).then(function(){

var gd = document.getElementById('49056c21-fc71-44d1-813f-6ac5ff6442fc');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                            </script>        </div>
</body>
<p></html></p>
<h2 id="4-author-contributions-to-articles">4. Author contributions to articles</h2>
<p>You can go beyond just the 'basic' Trust Markers with Dimensions Research Integrity. You can also look at related data, such as recorded contributions to papers by individuals, or at which repositories data is being deposited in.</p>
<p>Let's take a look at author contributions by research categorisation (note: articles falling under multiple categories will be counted once in each category. Articles mentioning the same verb more than once are only counted once per category). This will help understand acknowledgement patterns in research and possibly identify discipline areas where practice is 'ahead of the curve'.</p>
<div class="highlight"><pre><span></span><code><span class="o">%%</span><span class="n">bigquery</span> <span class="n">cont_df</span>

<span class="n">SELECT</span>
    <span class="n">p</span><span class="o">.</span><span class="n">year</span><span class="p">,</span>
    <span class="n">cat</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
    <span class="n">contributor_verbs</span><span class="p">,</span>
    <span class="n">COUNT</span><span class="p">(</span><span class="n">DISTINCT</span> <span class="n">p</span><span class="o">.</span><span class="n">id</span><span class="p">)</span> <span class="n">publications</span>
<span class="n">FROM</span> <span class="n">dimensions</span><span class="o">-</span><span class="n">ai</span><span class="o">.</span><span class="n">data_analytics</span><span class="o">.</span><span class="n">publications</span> <span class="n">p</span><span class="p">,</span>
    <span class="n">UNNEST</span><span class="p">(</span><span class="n">category_for</span><span class="o">.</span><span class="n">first_level</span><span class="o">.</span><span class="n">full</span><span class="p">)</span> <span class="n">cat</span>
<span class="n">INNER</span> <span class="n">JOIN</span> <span class="err">`</span><span class="n">dimensions</span><span class="o">-</span><span class="n">ai</span><span class="o">-</span><span class="n">integrity</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">trust_markers</span><span class="err">`</span> <span class="n">tm</span>
    <span class="n">ON</span> <span class="n">p</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">tm</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
    <span class="n">UNNEST</span><span class="p">(</span><span class="n">tm</span><span class="o">.</span><span class="n">authors</span><span class="o">.</span><span class="n">author_roles</span><span class="o">.</span><span class="n">keywords</span><span class="p">)</span> <span class="n">contributor_verbs</span>
<span class="n">WHERE</span>  <span class="n">p</span><span class="o">.</span><span class="n">type</span><span class="o">=</span> <span class="s1">&#39;article&#39;</span> <span class="ow">and</span> <span class="n">p</span><span class="o">.</span><span class="n">year</span> <span class="n">between</span> <span class="mi">2011</span> <span class="ow">and</span> <span class="mi">2022</span>
<span class="n">group</span> <span class="n">by</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>Query is running:   0%|          |



Downloading:   0%|          |
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1">#see what we get</span>
<span class="n">cont_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</code></pre></div>
<div id="df-945121b3-d838-4e96-882e-6afa1413ca58">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>year</th>
      <th>name</th>
      <th>contributor_verbs</th>
      <th>publications</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2021</td>
      <td>Biomedical And Clinical Sciences</td>
      <td>using</td>
      <td>2733</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2016</td>
      <td>Biomedical And Clinical Sciences</td>
      <td>using</td>
      <td>1108</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2022</td>
      <td>Psychology</td>
      <td>using</td>
      <td>315</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2015</td>
      <td>Biomedical And Clinical Sciences</td>
      <td>using</td>
      <td>723</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2021</td>
      <td>Agricultural, Veterinary And Food Sciences</td>
      <td>using</td>
      <td>456</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-945121b3-d838-4e96-882e-6afa1413ca58')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-945121b3-d838-4e96-882e-6afa1413ca58 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-945121b3-d838-4e96-882e-6afa1413ca58');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>

<p>There are a lot of variables (field and verbs) here and we can't visualise them all in one go. Instead, let's identify the top five verbs and six fields (by number of publications) and stick with just those for now.</p>
<div class="highlight"><pre><span></span><code><span class="c1">#get the most common verbs</span>
<span class="n">common_verbs</span> <span class="o">=</span> <span class="p">(</span><span class="n">cont_df</span><span class="o">.</span>
                <span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;contributor_verbs&quot;</span><span class="p">],</span> <span class="n">as_index</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span><span class="o">.</span>
                <span class="n">agg</span><span class="p">({</span><span class="s2">&quot;publications&quot;</span><span class="p">:</span> <span class="s2">&quot;sum&quot;</span><span class="p">})</span><span class="o">.</span>
                <span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;publications&quot;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span><span class="o">.</span>
                <span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
                <span class="p">)[</span><span class="s2">&quot;contributor_verbs&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>

<span class="n">common_verbs</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>[&#39;performed&#39;, &#39;wrote&#39;, &#39;designed&#39;, &#39;contributed&#39;, &#39;approved&#39;]
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1">#and the most common fields</span>
<span class="n">common_fields</span> <span class="o">=</span> <span class="p">(</span><span class="n">cont_df</span><span class="o">.</span>
                <span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;name&quot;</span><span class="p">],</span> <span class="n">as_index</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span><span class="o">.</span>
                <span class="n">agg</span><span class="p">({</span><span class="s2">&quot;publications&quot;</span><span class="p">:</span> <span class="s2">&quot;sum&quot;</span><span class="p">})</span><span class="o">.</span>
                <span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;publications&quot;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span><span class="o">.</span>
                <span class="n">head</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
                <span class="p">)[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>

<span class="n">common_fields</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>[&#39;Biomedical And Clinical Sciences&#39;,
 &#39;Biological Sciences&#39;,
 &#39;Engineering&#39;,
 &#39;Health Sciences&#39;,
 &#39;Chemical Sciences&#39;,
 &#39;Agricultural, Veterinary And Food Sciences&#39;]
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1">#filter the data accordingly and sort</span>
<span class="n">cont_df</span> <span class="o">=</span> <span class="n">cont_df</span><span class="p">[(</span><span class="n">cont_df</span><span class="p">[</span><span class="s2">&quot;contributor_verbs&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">common_verbs</span><span class="p">))</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">cont_df</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">common_fields</span><span class="p">))]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;year&quot;</span><span class="p">)</span>

<span class="c1">#and now plot the results</span>
<span class="n">plot</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">line</span><span class="p">(</span>
    <span class="n">cont_df</span><span class="p">,</span>
    <span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;year&quot;</span><span class="p">,</span>
    <span class="n">y</span> <span class="o">=</span> <span class="s2">&quot;publications&quot;</span><span class="p">,</span>
    <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;contributor_verbs&quot;</span><span class="p">,</span>
    <span class="n">facet_col</span> <span class="o">=</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span>
    <span class="n">facet_col_wrap</span> <span class="o">=</span> <span class="mi">3</span>
<span class="p">)</span>
<span class="n">plot</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>
<p><html>
<head><meta charset="utf-8" /></head></p>
<body>
    <div>            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script src="https://cdn.plot.ly/plotly-2.18.2.min.js"></script>                <div id="25efd650-69bd-4c0c-a99a-0ac3b03e67cd" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("25efd650-69bd-4c0c-a99a-0ac3b03e67cd")) {                    Plotly.newPlot(                        "25efd650-69bd-4c0c-a99a-0ac3b03e67cd",                        [{"hovertemplate":"contributor_verbs=designed<br>name=Engineering<br>year=%{x}<br>publications=%{y}<extra></extra>","legendgroup":"designed","line":{"color":"#636efa","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"designed","orientation":"v","showlegend":true,"x":[2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022],"xaxis":"x4","y":[861,1380,2414,3311,5723,8607,12057,13758,11558,12595,12113,12479],"yaxis":"y4","type":"scatter"},{"hovertemplate":"contributor_verbs=designed<br>name=Biomedical And Clinical Sciences<br>year=%{x}<br>publications=%{y}<extra></extra>","legendgroup":"designed","line":{"color":"#636efa","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"designed","orientation":"v","showlegend":false,"x":[2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022],"xaxis":"x5","y":[15171,22400,30336,32837,37739,37973,38436,42895,47782,57381,65233,65204],"yaxis":"y5","type":"scatter"},{"hovertemplate":"contributor_verbs=designed<br>name=Chemical Sciences<br>year=%{x}<br>publications=%{y}<extra></extra>","legendgroup":"designed","line":{"color":"#636efa","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"designed","orientation":"v","showlegend":false,"x":[2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022],"xaxis":"x6","y":[1126,1743,2589,3321,5394,7098,8799,10463,10236,10785,11830,12239],"yaxis":"y6","type":"scatter"},{"hovertemplate":"contributor_verbs=designed<br>name=Biological Sciences<br>year=%{x}<br>publications=%{y}<extra></extra>","legendgroup":"designed","line":{"color":"#636efa","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"designed","orientation":"v","showlegend":false,"x":[2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022],"xaxis":"x","y":[15418,20917,26693,27837,33440,35520,33729,35763,38780,42364,46366,44778],"yaxis":"y","type":"scatter"},{"hovertemplate":"contributor_verbs=designed<br>name=Agricultural, Veterinary And Food Sciences<br>year=%{x}<br>publications=%{y}<extra></extra>","legendgroup":"designed","line":{"color":"#636efa","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"designed","orientation":"v","showlegend":false,"x":[2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022],"xaxis":"x2","y":[998,1911,2786,3491,4636,5069,4840,5801,7137,8841,10029,10311],"yaxis":"y2","type":"scatter"},{"hovertemplate":"contributor_verbs=designed<br>name=Health Sciences<br>year=%{x}<br>publications=%{y}<extra></extra>","legendgroup":"designed","line":{"color":"#636efa","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"designed","orientation":"v","showlegend":false,"x":[2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022],"xaxis":"x3","y":[2394,3761,5639,6487,7754,7309,6200,7204,8133,10177,11662,12023],"yaxis":"y3","type":"scatter"},{"hovertemplate":"contributor_verbs=performed<br>name=Engineering<br>year=%{x}<br>publications=%{y}<extra></extra>","legendgroup":"performed","line":{"color":"#EF553B","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"performed","orientation":"v","showlegend":true,"x":[2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022],"xaxis":"x4","y":[961,1530,2679,3744,6452,9616,13196,14835,13299,15179,16083,18236],"yaxis":"y4","type":"scatter"},{"hovertemplate":"contributor_verbs=performed<br>name=Biomedical And Clinical Sciences<br>year=%{x}<br>publications=%{y}<extra></extra>","legendgroup":"performed","line":{"color":"#EF553B","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"performed","orientation":"v","showlegend":false,"x":[2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022],"xaxis":"x5","y":[17357,25847,33683,36752,41700,41245,40210,44682,49842,59821,70488,71837],"yaxis":"y5","type":"scatter"},{"hovertemplate":"contributor_verbs=performed<br>name=Chemical Sciences<br>year=%{x}<br>publications=%{y}<extra></extra>","legendgroup":"performed","line":{"color":"#EF553B","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"performed","orientation":"v","showlegend":false,"x":[2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022],"xaxis":"x6","y":[1184,1853,2807,3790,6142,8160,10075,11978,12247,13366,15509,17093],"yaxis":"y6","type":"scatter"},{"hovertemplate":"contributor_verbs=performed<br>name=Biological Sciences<br>year=%{x}<br>publications=%{y}<extra></extra>","legendgroup":"performed","line":{"color":"#EF553B","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"performed","orientation":"v","showlegend":false,"x":[2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022],"xaxis":"x","y":[16162,21609,27545,29167,34976,36986,34816,37081,40259,44639,49756,49706],"yaxis":"y","type":"scatter"},{"hovertemplate":"contributor_verbs=performed<br>name=Agricultural, Veterinary And Food Sciences<br>year=%{x}<br>publications=%{y}<extra></extra>","legendgroup":"performed","line":{"color":"#EF553B","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"performed","orientation":"v","showlegend":false,"x":[2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022],"xaxis":"x2","y":[1064,1995,2844,3506,4427,4807,4434,5127,6570,8393,9769,10397],"yaxis":"y2","type":"scatter"},{"hovertemplate":"contributor_verbs=performed<br>name=Health Sciences<br>year=%{x}<br>publications=%{y}<extra></extra>","legendgroup":"performed","line":{"color":"#EF553B","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"performed","orientation":"v","showlegend":false,"x":[2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022],"xaxis":"x3","y":[2624,3730,5232,5948,7099,6253,4717,5256,5796,7532,9487,9987],"yaxis":"y3","type":"scatter"},{"hovertemplate":"contributor_verbs=wrote<br>name=Engineering<br>year=%{x}<br>publications=%{y}<extra></extra>","legendgroup":"wrote","line":{"color":"#00cc96","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"wrote","orientation":"v","showlegend":true,"x":[2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022],"xaxis":"x4","y":[830,1383,2444,3238,6378,9477,13145,15224,13598,15177,15348,16069],"yaxis":"y4","type":"scatter"},{"hovertemplate":"contributor_verbs=wrote<br>name=Biomedical And Clinical Sciences<br>year=%{x}<br>publications=%{y}<extra></extra>","legendgroup":"wrote","line":{"color":"#00cc96","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"wrote","orientation":"v","showlegend":false,"x":[2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022],"xaxis":"x5","y":[15203,22498,29903,29987,37720,37785,37132,40874,45452,55566,65083,67174],"yaxis":"y5","type":"scatter"},{"hovertemplate":"contributor_verbs=wrote<br>name=Chemical Sciences<br>year=%{x}<br>publications=%{y}<extra></extra>","legendgroup":"wrote","line":{"color":"#00cc96","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"wrote","orientation":"v","showlegend":false,"x":[2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022],"xaxis":"x6","y":[1133,1751,2617,3312,5785,7688,9153,10519,10474,11559,13148,14371],"yaxis":"y6","type":"scatter"},{"hovertemplate":"contributor_verbs=wrote<br>name=Biological Sciences<br>year=%{x}<br>publications=%{y}<extra></extra>","legendgroup":"wrote","line":{"color":"#00cc96","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"wrote","orientation":"v","showlegend":false,"x":[2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022],"xaxis":"x","y":[15621,20979,26568,25920,34827,37581,35844,36387,39422,44009,48868,47377],"yaxis":"y","type":"scatter"},{"hovertemplate":"contributor_verbs=wrote<br>name=Agricultural, Veterinary And Food Sciences<br>year=%{x}<br>publications=%{y}<extra></extra>","legendgroup":"wrote","line":{"color":"#00cc96","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"wrote","orientation":"v","showlegend":false,"x":[2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022],"xaxis":"x2","y":[964,1812,2643,2888,4420,4878,4635,5201,6455,8261,9783,10320],"yaxis":"y2","type":"scatter"},{"hovertemplate":"contributor_verbs=wrote<br>name=Health Sciences<br>year=%{x}<br>publications=%{y}<extra></extra>","legendgroup":"wrote","line":{"color":"#00cc96","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"wrote","orientation":"v","showlegend":false,"x":[2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022],"xaxis":"x3","y":[2297,3741,5426,5821,7485,6832,5438,6185,7138,9203,10768,11829],"yaxis":"y3","type":"scatter"},{"hovertemplate":"contributor_verbs=contributed<br>name=Engineering<br>year=%{x}<br>publications=%{y}<extra></extra>","legendgroup":"contributed","line":{"color":"#ab63fa","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"contributed","orientation":"v","showlegend":true,"x":[2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022],"xaxis":"x4","y":[995,1713,2709,3959,6390,8435,10894,13186,13676,16534,19145,22579],"yaxis":"y4","type":"scatter"},{"hovertemplate":"contributor_verbs=contributed<br>name=Biomedical And Clinical Sciences<br>year=%{x}<br>publications=%{y}<extra></extra>","legendgroup":"contributed","line":{"color":"#ab63fa","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"contributed","orientation":"v","showlegend":false,"x":[2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022],"xaxis":"x5","y":[12848,18930,25410,29421,32439,31477,29526,34023,39920,55927,75971,85951],"yaxis":"y5","type":"scatter"},{"hovertemplate":"contributor_verbs=contributed<br>name=Chemical Sciences<br>year=%{x}<br>publications=%{y}<extra></extra>","legendgroup":"contributed","line":{"color":"#ab63fa","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"contributed","orientation":"v","showlegend":false,"x":[2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022],"xaxis":"x6","y":[1434,2485,3571,4661,5942,7461,9046,10895,12024,13883,16138,17814],"yaxis":"y6","type":"scatter"},{"hovertemplate":"contributor_verbs=contributed<br>name=Biological Sciences<br>year=%{x}<br>publications=%{y}<extra></extra>","legendgroup":"contributed","line":{"color":"#ab63fa","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"contributed","orientation":"v","showlegend":false,"x":[2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022],"xaxis":"x","y":[10670,14811,18439,19533,21110,20114,16549,18066,20228,24463,31007,33158],"yaxis":"y","type":"scatter"},{"hovertemplate":"contributor_verbs=contributed<br>name=Agricultural, Veterinary And Food Sciences<br>year=%{x}<br>publications=%{y}<extra></extra>","legendgroup":"contributed","line":{"color":"#ab63fa","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"contributed","orientation":"v","showlegend":false,"x":[2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022],"xaxis":"x2","y":[843,1509,2189,2818,3509,3298,2742,3384,4490,6012,8048,9865],"yaxis":"y2","type":"scatter"},{"hovertemplate":"contributor_verbs=contributed<br>name=Health Sciences<br>year=%{x}<br>publications=%{y}<extra></extra>","legendgroup":"contributed","line":{"color":"#ab63fa","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"contributed","orientation":"v","showlegend":false,"x":[2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022],"xaxis":"x3","y":[2893,4238,5994,7205,8505,8427,7747,9034,10432,14314,18237,21096],"yaxis":"y3","type":"scatter"},{"hovertemplate":"contributor_verbs=approved<br>name=Engineering<br>year=%{x}<br>publications=%{y}<extra></extra>","legendgroup":"approved","line":{"color":"#FFA15A","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"approved","orientation":"v","showlegend":true,"x":[2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022],"xaxis":"x4","y":[535,917,1184,1490,2032,2656,3346,4466,5064,6484,9216,12405],"yaxis":"y4","type":"scatter"},{"hovertemplate":"contributor_verbs=approved<br>name=Biomedical And Clinical Sciences<br>year=%{x}<br>publications=%{y}<extra></extra>","legendgroup":"approved","line":{"color":"#FFA15A","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"approved","orientation":"v","showlegend":false,"x":[2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022],"xaxis":"x5","y":[11419,15061,19200,23989,28659,31555,36414,44515,54008,74022,100388,111296],"yaxis":"y5","type":"scatter"},{"hovertemplate":"contributor_verbs=approved<br>name=Chemical Sciences<br>year=%{x}<br>publications=%{y}<extra></extra>","legendgroup":"approved","line":{"color":"#FFA15A","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"approved","orientation":"v","showlegend":false,"x":[2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022],"xaxis":"x6","y":[146,302,475,514,1351,1784,2314,3821,4435,5092,6057,6490],"yaxis":"y6","type":"scatter"},{"hovertemplate":"contributor_verbs=approved<br>name=Biological Sciences<br>year=%{x}<br>publications=%{y}<extra></extra>","legendgroup":"approved","line":{"color":"#FFA15A","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"approved","orientation":"v","showlegend":false,"x":[2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022],"xaxis":"x","y":[5317,5633,7234,8743,11703,14447,16099,19437,23871,29746,38263,39753],"yaxis":"y","type":"scatter"},{"hovertemplate":"contributor_verbs=approved<br>name=Agricultural, Veterinary And Food Sciences<br>year=%{x}<br>publications=%{y}<extra></extra>","legendgroup":"approved","line":{"color":"#FFA15A","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"approved","orientation":"v","showlegend":false,"x":[2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022],"xaxis":"x2","y":[392,664,884,1241,1793,2486,2965,3977,5552,7611,10349,12235],"yaxis":"y2","type":"scatter"},{"hovertemplate":"contributor_verbs=approved<br>name=Health Sciences<br>year=%{x}<br>publications=%{y}<extra></extra>","legendgroup":"approved","line":{"color":"#FFA15A","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"approved","orientation":"v","showlegend":false,"x":[2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021,2022],"xaxis":"x3","y":[4196,5338,6965,8417,9807,10504,11975,13948,16201,20847,26067,30030],"yaxis":"y3","type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,0.31999999999999995],"title":{"text":"year"}},"yaxis":{"anchor":"x","domain":[0.0,0.46499999999999997],"title":{"text":"publications"}},"xaxis2":{"anchor":"y2","domain":[0.33999999999999997,0.6599999999999999],"matches":"x","title":{"text":"year"}},"yaxis2":{"anchor":"x2","domain":[0.0,0.46499999999999997],"matches":"y","showticklabels":false},"xaxis3":{"anchor":"y3","domain":[0.6799999999999999,0.9999999999999999],"matches":"x","title":{"text":"year"}},"yaxis3":{"anchor":"x3","domain":[0.0,0.46499999999999997],"matches":"y","showticklabels":false},"xaxis4":{"anchor":"y4","domain":[0.0,0.31999999999999995],"matches":"x","showticklabels":false},"yaxis4":{"anchor":"x4","domain":[0.5349999999999999,0.9999999999999999],"matches":"y","title":{"text":"publications"}},"xaxis5":{"anchor":"y5","domain":[0.33999999999999997,0.6599999999999999],"matches":"x","showticklabels":false},"yaxis5":{"anchor":"x5","domain":[0.5349999999999999,0.9999999999999999],"matches":"y","showticklabels":false},"xaxis6":{"anchor":"y6","domain":[0.6799999999999999,0.9999999999999999],"matches":"x","showticklabels":false},"yaxis6":{"anchor":"x6","domain":[0.5349999999999999,0.9999999999999999],"matches":"y","showticklabels":false},"annotations":[{"font":{},"showarrow":false,"text":"name=Biological Sciences","x":0.15999999999999998,"xanchor":"center","xref":"paper","y":0.46499999999999997,"yanchor":"bottom","yref":"paper"},{"font":{},"showarrow":false,"text":"name=Agricultural, Veterinary And Food Sciences","x":0.49999999999999994,"xanchor":"center","xref":"paper","y":0.46499999999999997,"yanchor":"bottom","yref":"paper"},{"font":{},"showarrow":false,"text":"name=Health Sciences","x":0.8399999999999999,"xanchor":"center","xref":"paper","y":0.46499999999999997,"yanchor":"bottom","yref":"paper"},{"font":{},"showarrow":false,"text":"name=Engineering","x":0.15999999999999998,"xanchor":"center","xref":"paper","y":0.9999999999999999,"yanchor":"bottom","yref":"paper"},{"font":{},"showarrow":false,"text":"name=Biomedical And Clinical Sciences","x":0.49999999999999994,"xanchor":"center","xref":"paper","y":0.9999999999999999,"yanchor":"bottom","yref":"paper"},{"font":{},"showarrow":false,"text":"name=Chemical Sciences","x":0.8399999999999999,"xanchor":"center","xref":"paper","y":0.9999999999999999,"yanchor":"bottom","yref":"paper"}],"legend":{"title":{"text":"contributor_verbs"},"tracegroupgap":0},"margin":{"t":60}},                        {"responsive": true}                    ).then(function(){

var gd = document.getElementById('25efd650-69bd-4c0c-a99a-0ac3b03e67cd');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                            </script>        </div>
</body>
<p></html></p>
<h2 id="5-repository-usage">5. Repository usage</h2>
<p>Now we'll take a look at how we can access the repositories data. Suppose we want to see the breadth of usage of specific repositories across work across funders and research orgs, to understand how wide the usage of the most common repositories is.</p>
<div class="highlight"><pre><span></span><code><span class="o">%%</span><span class="n">bigquery</span> <span class="n">repo_df</span>

<span class="o">--</span><span class="n">the</span> <span class="n">first</span> <span class="n">two</span> <span class="n">tables</span> <span class="n">created</span> <span class="n">by</span> <span class="n">the</span> <span class="n">WITH</span> <span class="n">statements</span> <span class="n">are</span> <span class="n">needed</span> <span class="n">to</span> <span class="n">get</span> <span class="n">full</span> <span class="n">count</span> <span class="n">of</span> <span class="n">repositories</span> <span class="n">based</span> <span class="n">on</span> <span class="n">names</span> <span class="ow">and</span> <span class="n">URLs</span> <span class="n">found</span>
<span class="n">WITH</span>
  <span class="n">common_keywords</span> <span class="n">AS</span><span class="p">(</span>
  <span class="n">SELECT</span>
    <span class="n">kw</span><span class="p">,</span>
    <span class="n">COUNT</span><span class="p">(</span><span class="n">DISTINCT</span> <span class="nb">id</span><span class="p">)</span> <span class="n">AS</span> <span class="n">pubs</span>
  <span class="n">FROM</span> <span class="err">`</span><span class="n">dimensions</span><span class="o">-</span><span class="n">ai</span><span class="o">-</span><span class="n">integrity</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">trust_markers</span><span class="err">`</span> <span class="n">tm</span><span class="p">,</span>
    <span class="n">UNNEST</span><span class="p">(</span><span class="n">tm</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">data_locations</span><span class="o">.</span><span class="n">repositories</span><span class="p">)</span> <span class="n">kw</span>
  <span class="n">GROUP</span> <span class="n">BY</span> <span class="mi">1</span>
<span class="p">),</span>
<span class="n">repositories</span> <span class="n">AS</span><span class="p">(</span>
  <span class="n">SELECT</span>
  <span class="nb">id</span><span class="p">,</span>
  <span class="n">kw</span><span class="p">,</span>
  <span class="s1">&#39;url&#39;</span> <span class="n">isin</span>
    <span class="n">FROM</span> <span class="err">`</span><span class="n">dimensions</span><span class="o">-</span><span class="n">ai</span><span class="o">-</span><span class="n">integrity</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">trust_markers</span><span class="err">`</span> <span class="n">tm</span><span class="p">,</span>
      <span class="n">UNNEST</span><span class="p">(</span><span class="n">tm</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">data_locations</span><span class="o">.</span><span class="n">repository_urls</span><span class="p">)</span> <span class="n">url</span>
    <span class="n">INNER</span> <span class="n">JOIN</span> <span class="n">common_keywords</span>
      <span class="n">ON</span> <span class="n">REGEXP_CONTAINS</span><span class="p">(</span><span class="n">REPLACE</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="s1">&#39;10.17632&#39;</span><span class="p">,</span><span class="s1">&#39;mendeley&#39;</span><span class="p">),</span> <span class="n">LOWER</span><span class="p">(</span><span class="n">kw</span><span class="p">))</span>
    <span class="n">UNION</span> <span class="n">DISTINCT</span>
      <span class="n">SELECT</span>
        <span class="nb">id</span><span class="p">,</span>
          <span class="n">replace</span><span class="p">(</span>
            <span class="n">replace</span><span class="p">(</span>
              <span class="c1">#replace(</span>
                <span class="n">replace</span><span class="p">(</span><span class="n">kw</span><span class="p">,</span><span class="s1">&#39;open science framework&#39;</span><span class="p">,</span><span class="s1">&#39;osf&#39;</span><span class="p">),</span>
              <span class="c1">#&#39;gene&#39;,&#39;geo&#39;),</span>
              <span class="s1">&#39;gene expression omnibus&#39;</span><span class="p">,</span><span class="s1">&#39;geo&#39;</span><span class="p">),</span>
            <span class="s1">&#39;sequence read archive&#39;</span><span class="p">,</span><span class="s1">&#39;sra&#39;</span><span class="p">)</span> <span class="n">kw</span><span class="p">,</span>
        <span class="s1">&#39;keyword&#39;</span> <span class="n">isin</span>
        <span class="n">FROM</span> <span class="err">`</span><span class="n">dimensions</span><span class="o">-</span><span class="n">ai</span><span class="o">-</span><span class="n">integrity</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">trust_markers</span><span class="err">`</span> <span class="n">tm</span><span class="p">,</span>
          <span class="n">UNNEST</span><span class="p">(</span><span class="n">tm</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">data_locations</span><span class="o">.</span><span class="n">repositories</span><span class="p">)</span> <span class="n">kw</span>
        <span class="n">WHERE</span> <span class="n">kw</span> <span class="o">!=</span> <span class="s1">&#39;board&#39;</span>
        <span class="p">),</span>
  <span class="n">funders</span> <span class="n">AS</span><span class="p">(</span>
    <span class="n">SELECT</span>
    <span class="n">pubs</span><span class="o">.</span><span class="n">id</span> <span class="n">AS</span> <span class="n">pub_id</span><span class="p">,</span>
    <span class="n">fund</span><span class="o">.</span><span class="n">grid_id</span> <span class="n">AS</span> <span class="n">funder_id</span>
    <span class="n">FROM</span> <span class="err">`</span><span class="n">dimensions</span><span class="o">-</span><span class="n">ai</span><span class="o">.</span><span class="n">data_analytics</span><span class="o">.</span><span class="n">publications</span><span class="err">`</span> <span class="n">pubs</span><span class="p">,</span>
      <span class="n">UNNEST</span><span class="p">(</span><span class="n">funding_details</span><span class="p">)</span> <span class="n">fund</span>
    <span class="n">WHERE</span> <span class="n">pubs</span><span class="o">.</span><span class="n">year</span> <span class="o">=</span> <span class="mi">2021</span>
  <span class="p">),</span>
  <span class="n">orgs</span> <span class="n">AS</span><span class="p">(</span>
    <span class="n">SELECT</span>
      <span class="n">pubs</span><span class="o">.</span><span class="n">id</span> <span class="n">AS</span> <span class="n">pub_id</span><span class="p">,</span>
      <span class="n">org</span>
    <span class="n">FROM</span> <span class="err">`</span><span class="n">dimensions</span><span class="o">-</span><span class="n">ai</span><span class="o">.</span><span class="n">data_analytics</span><span class="o">.</span><span class="n">publications</span><span class="err">`</span> <span class="n">pubs</span><span class="p">,</span>
      <span class="n">UNNEST</span><span class="p">(</span><span class="n">research_orgs</span><span class="p">)</span> <span class="n">org</span>
    <span class="n">WHERE</span> <span class="n">pubs</span><span class="o">.</span><span class="n">year</span> <span class="o">=</span> <span class="mi">2021</span>
  <span class="p">),</span> <span class="n">combined</span> <span class="n">AS</span><span class="p">(</span>
  <span class="n">SELECT</span>
    <span class="n">rep</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
     <span class="n">CASE</span>
        <span class="n">WHEN</span> <span class="n">REGEXP_CONTAINS</span><span class="p">(</span><span class="n">rep</span><span class="o">.</span><span class="n">kw</span><span class="p">,</span> <span class="s1">&#39;github&#39;</span><span class="p">)</span> <span class="n">THEN</span> <span class="s1">&#39;github&#39;</span>
        <span class="n">WHEN</span> <span class="n">REGEXP_CONTAINS</span><span class="p">(</span><span class="n">rep</span><span class="o">.</span><span class="n">kw</span><span class="p">,</span> <span class="s1">&#39;osf&#39;</span><span class="p">)</span> <span class="n">THEN</span> <span class="s1">&#39;osf&#39;</span>
        <span class="n">WHEN</span> <span class="n">REGEXP_CONTAINS</span><span class="p">(</span><span class="n">rep</span><span class="o">.</span><span class="n">kw</span><span class="p">,</span> <span class="s1">&#39;ncbi&#39;</span><span class="p">)</span> <span class="n">THEN</span> <span class="s1">&#39;ncbi&#39;</span>
        <span class="n">ELSE</span> <span class="n">rep</span><span class="o">.</span><span class="n">kw</span>
      <span class="n">END</span> <span class="n">AS</span> <span class="n">kw</span><span class="p">,</span>
    <span class="n">f</span><span class="o">.</span><span class="n">funder_id</span> <span class="n">AS</span> <span class="n">funder</span><span class="p">,</span>
    <span class="n">o</span><span class="o">.</span><span class="n">org</span> <span class="n">AS</span> <span class="n">ro</span>
  <span class="n">FROM</span> <span class="n">repositories</span> <span class="n">rep</span>
  <span class="n">INNER</span> <span class="n">JOIN</span> <span class="n">funders</span> <span class="n">f</span>
    <span class="n">ON</span> <span class="n">rep</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">pub_id</span>
  <span class="n">INNER</span> <span class="n">JOIN</span> <span class="n">orgs</span> <span class="n">o</span>
    <span class="n">ON</span> <span class="n">rep</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">o</span><span class="o">.</span><span class="n">pub_id</span>
  <span class="p">)</span>
  <span class="n">SELECT</span>
  <span class="n">kw</span><span class="p">,</span>
  <span class="n">COUNT</span><span class="p">(</span><span class="n">DISTINCT</span> <span class="n">funder</span><span class="p">)</span> <span class="n">AS</span> <span class="n">funders</span><span class="p">,</span>
  <span class="n">COUNT</span><span class="p">(</span><span class="n">DISTINCT</span> <span class="n">ro</span><span class="p">)</span> <span class="n">AS</span> <span class="n">orgs</span><span class="p">,</span>
  <span class="n">COUNT</span><span class="p">(</span><span class="n">DISTINCT</span> <span class="nb">id</span><span class="p">)</span> <span class="n">AS</span> <span class="n">pubs</span>
  <span class="n">FROM</span> <span class="n">combined</span>
  <span class="n">GROUP</span> <span class="n">BY</span> <span class="mi">1</span>
  <span class="n">ORDER</span> <span class="n">BY</span> <span class="n">pubs</span> <span class="n">DESC</span>
  <span class="n">LIMIT</span> <span class="mi">10</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>Query is running:   0%|          |



Downloading:   0%|          |
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1">#see what we&#39;ve got</span>
<span class="n">repo_df</span>
</code></pre></div>
<div id="df-338dc8f7-c935-4eb7-b522-3c2c231be6f7">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>kw</th>
      <th>funders</th>
      <th>orgs</th>
      <th>pubs</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>ncbi</td>
      <td>1858</td>
      <td>7378</td>
      <td>16104</td>
    </tr>
    <tr>
      <th>1</th>
      <td>github</td>
      <td>1680</td>
      <td>6787</td>
      <td>13160</td>
    </tr>
    <tr>
      <th>2</th>
      <td>geo</td>
      <td>1456</td>
      <td>5115</td>
      <td>8802</td>
    </tr>
    <tr>
      <th>3</th>
      <td>zenodo</td>
      <td>1175</td>
      <td>4828</td>
      <td>6757</td>
    </tr>
    <tr>
      <th>4</th>
      <td>gene</td>
      <td>1429</td>
      <td>5311</td>
      <td>6441</td>
    </tr>
    <tr>
      <th>5</th>
      <td>bioproject</td>
      <td>1136</td>
      <td>4369</td>
      <td>5925</td>
    </tr>
    <tr>
      <th>6</th>
      <td>sra</td>
      <td>1172</td>
      <td>4292</td>
      <td>5817</td>
    </tr>
    <tr>
      <th>7</th>
      <td>genbank</td>
      <td>1025</td>
      <td>4123</td>
      <td>5019</td>
    </tr>
    <tr>
      <th>8</th>
      <td>figshare</td>
      <td>1164</td>
      <td>4422</td>
      <td>4683</td>
    </tr>
    <tr>
      <th>9</th>
      <td>impact</td>
      <td>1176</td>
      <td>4649</td>
      <td>3659</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-338dc8f7-c935-4eb7-b522-3c2c231be6f7')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-338dc8f7-c935-4eb7-b522-3c2c231be6f7 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-338dc8f7-c935-4eb7-b522-3c2c231be6f7');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>

<div class="highlight"><pre><span></span><code><span class="c1">#plot</span>
<span class="n">plot</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
    <span class="n">repo_df</span><span class="p">,</span>
    <span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;funders&quot;</span><span class="p">,</span>
    <span class="n">y</span> <span class="o">=</span> <span class="s2">&quot;orgs&quot;</span><span class="p">,</span>
    <span class="n">hover_data</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;kw&quot;</span><span class="p">]</span>
<span class="p">)</span>

<span class="n">plot</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>
<p><html>
<head><meta charset="utf-8" /></head></p>
<body>
    <div>            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script src="https://cdn.plot.ly/plotly-2.18.2.min.js"></script>                <div id="6ec355be-87fa-4847-a2bb-2ce8b77e8d44" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("6ec355be-87fa-4847-a2bb-2ce8b77e8d44")) {                    Plotly.newPlot(                        "6ec355be-87fa-4847-a2bb-2ce8b77e8d44",                        [{"customdata":[["ncbi"],["github"],["geo"],["zenodo"],["gene"],["bioproject"],["sra"],["genbank"],["figshare"],["impact"]],"hovertemplate":"funders=%{x}<br>orgs=%{y}<br>kw=%{customdata[0]}<extra></extra>","legendgroup":"","marker":{"color":"#636efa","symbol":"circle"},"mode":"markers","name":"","orientation":"v","showlegend":false,"x":[1858,1680,1456,1175,1429,1136,1172,1025,1164,1176],"xaxis":"x","y":[7378,6787,5115,4828,5311,4369,4292,4123,4422,4649],"yaxis":"y","type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"funders"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"orgs"}},"legend":{"tracegroupgap":0},"margin":{"t":60}},                        {"responsive": true}                    ).then(function(){

var gd = document.getElementById('6ec355be-87fa-4847-a2bb-2ce8b77e8d44');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                            </script>        </div>
</body>
<p></html></p>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../07-retrieve_patents/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Retrieve patents linked to a set of grants" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Retrieve patents linked to a set of grants
            </div>
          </div>
        </a>
      
      
        
        <a href="../../collections/" class="md-footer__link md-footer__link--next" aria-label="Next: About" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              About
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            © Copyright 2021-2024 Digital Science & Research Solutions, Inc. All Rights Reserved | <a href="https://www.dimensions.ai/">About us</a> · <a href="https://www.dimensions.ai/privacy/">Privacy policy</a> · <a href="https://www.dimensions.ai/website-terms/">Legal terms</a>
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../assets/javascripts/workers/search.409db549.min.js", "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.756773cc.min.js"></script>
      
    
  </body>
</html>